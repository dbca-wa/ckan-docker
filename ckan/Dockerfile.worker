ARG CKAN_IMAGE
FROM ${CKAN_IMAGE}

# Install logrotate
RUN apk add logrotate
# Create logrotate config file for app logs
COPY setup/dbca_ckan_rotate_logs /etc/logrotate.d/dbca_ckan_rotate_logs

## Supervisor config
COPY supervisor/*.conf /etc/supervisord.d

## Cron jobs config
COPY setup/dbca_ckan_cron_jobs $APP_DIR
RUN chmod -x $APP_DIR/dbca_ckan_cron_jobs
RUN crontab -u ckan $APP_DIR/dbca_ckan_cron_jobs
